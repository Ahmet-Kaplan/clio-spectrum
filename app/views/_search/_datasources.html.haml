- active ||= ""
- query = params['q'] || params['s.q'] || ""
- sources = [ {:title => "Quicksearch", :url => {:controller => "search"}}, {:title => "Catalog", :url => {:controller => "catalog"}}, {:title => "Articles", :url => {:controller => "articles", :action => "index"}}, {:title => "eBooks", :url => {:controller => "search", :action => "ebooks"}}]
- sidebar_items << capture do

  %ul#datasources
    %li.title Sources
    - sources.each do |item_hash|
      %li.source

        - if active == item_hash[:title]
          - url = "#"
          - options = {:class => "selected"}
        - else
          - if item_hash[:title] == "Articles" && !query.empty?
            - url = {:controller => "articles", :action => "search",  'new_search' => true, 's.q' => query}
          - else
            - url = item_hash[:url].merge(:q => query)
        = link_to item_hash[:title], url , options
