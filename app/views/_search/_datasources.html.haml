- active ||= ""
- sources = [ {:title => "Quicksearch", :url => {:controller => "search"}}, {:title => "Catalog", :url => {:controller => "catalog"}}, {:title => "Articles", :url => {:controller => "articles", :action => "index"}}]
- sidebar_items << capture do

  %ul#datasources
    %li.title Sources
    - sources.each do |item_hash|
      %li.source

        - if active == item_hash[:title]
          - url = "#"
          - options = {:class => "selected"}
        - else
          - if item_hash[:title] == "Articles" && !params['q'].to_s.empty?
            - url = {:controller => "articles", :action => "search",  'new_search' => true, 's.q' => params['q']}
          - else
            - url = item_hash[:url].merge(:q => params['q'])
        = link_to item_hash[:title], url , options
